<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - Krishi Kishan</title>
    <link rel="stylesheet" href="web.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      .login-page {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        position: relative;
        overflow: hidden;
        padding: 20px;
      }

      .login-page::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url("https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80")
          center/cover;
        opacity: 0.1;
        z-index: 0;
      }

      .login-container {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        position: relative;
        z-index: 1;
      }

      .login-image {
        padding: 2rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .login-image img {
        width: 100%;
        height: auto;
        border-radius: 15px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        transform: perspective(1000px) rotateY(-5deg);
        transition: transform 0.5s ease;
      }

      .login-image img:hover {
        transform: perspective(1000px) rotateY(0deg);
      }

      .login-content {
        padding: 3rem;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .login-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .login-header h2 {
        font-size: 3rem;
        color: #2c3e50;
        margin-bottom: 0.5rem;
        background: linear-gradient(45deg, #2c3e50, #3498db);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .login-header p {
        color: #7f8c8d;
        font-size: 1.2rem;
      }

      .login-form {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        color: #333;
        font-weight: 500;
      }

      .form-group input {
        width: 100%;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 16px;
        transition: border-color 0.3s ease;
      }

      .form-group input:focus {
        border-color: #4caf50;
        outline: none;
      }

      .btn {
        width: 100%;
        padding: 14px;
        background: #4caf50;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .btn:hover {
        background: #45a049;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .form-options {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .remember-me {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .remember-me input[type="checkbox"] {
        width: 1.2rem;
        height: 1.2rem;
        accent-color: #3498db;
      }

      .forgot-password {
        color: #4caf50;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
      }

      .forgot-password:hover {
        color: #45a049;
      }

      .register-link {
        text-align: center;
        margin-top: 20px;
      }

      .register-link a {
        color: #4caf50;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
      }

      .register-link a:hover {
        color: #45a049;
      }

      .social-login {
        margin-top: 2rem;
        text-align: center;
      }

      .social-login p {
        color: #7f8c8d;
        margin-bottom: 1rem;
      }

      .social-buttons {
        display: flex;
        justify-content: center;
        gap: 1rem;
      }

      .social-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .social-btn.google {
        background: #db4437;
        color: white;
      }

      .social-btn.facebook {
        background: #4267b2;
        color: white;
      }

      .social-btn.twitter {
        background: #1da1f2;
        color: white;
      }

      .social-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      @media (max-width: 992px) {
        .login-container {
          grid-template-columns: 1fr;
          max-width: 600px;
        }

        .login-image {
          display: none;
        }
      }

      @media (max-width: 576px) {
        .login-container {
          margin: 0;
          border-radius: 0;
        }

        .login-content {
          padding: 2rem;
        }

        .login-header h2 {
          font-size: 2.5rem;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="container header-content">
        <div class="logo">Krishi <span>Kishan</span></div>
        <nav>
          <ul>
            <li><a href="web.html" target="_blank">Home</a></li>
            <li>
              <a href="market-linkage.html" target="_blank">Market Linkage</a>
            </li>
            <li>
              <a href="soil-testing.html" target="_blank">Soil Testing</a>
            </li>
            <li><a href="chatbot.html" target="_blank">AI Chatbot</a></li>
            <li><a href="community.html" target="_blank">Community</a></li>
            <li><a href="renting.html" target="_blank">Rent Equipment</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <section class="login-page">
      <div class="container login-container">
        <div class="login-image">
          <img
            src="https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80"
            alt="Farming"
          />
        </div>
        <div class="login-content">
          <div class="login-header">
            <h2>Welcome Back</h2>
            <p>Login to access all farming services</p>
          </div>
          <form id="loginForm">
            <div class="form-group">
              <label for="email">Email</label>
              <input
                type="email"
                id="email"
                placeholder="Enter your email"
                required
              />
            </div>
            <div class="form-group">
              <label for="password">Password</label>
              <input
                type="password"
                id="password"
                placeholder="Enter your password"
                required
              />
            </div>
            <div class="form-options">
              <label class="remember-me">
                <input type="checkbox" id="remember" />
                <span>Remember me</span>
              </label>
              <a href="#" class="forgot-password">Forgot Password?</a>
            </div>
            <button type="submit" class="btn">Login</button>
            <div class="register-link">
              <p>
                Don't have an account?
                <a href="register.html" target="_blank" id="registerLink"
                  >Register</a
                >
              </p>
            </div>
          </form>

          <div class="social-login">
            <p>Or login with</p>
            <div class="social-buttons">
              <button class="social-btn google">
                <i class="fab fa-google"></i>
              </button>
              <button class="social-btn facebook">
                <i class="fab fa-facebook-f"></i>
              </button>
              <button class="social-btn twitter">
                <i class="fab fa-twitter"></i>
              </button>
            </div>
          </div>

          <div class="login-footer">
            <p>
              Don't have an account?
              <a href="register.html" target="_blank">Register here</a>
            </p>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <div class="container">
        <div class="footer-content">
          <div class="footer-logo">
            <div class="logo">Krishi <span>Kishan</span></div>
            <p>Empowering farmers with technology</p>
          </div>
          <div class="footer-links">
            <h4>Quick Links</h4>
            <ul>
              <li><a href="web.html" target="_blank">Home</a></li>
              <li>
                <a href="market-linkage.html" target="_blank">Market Linkage</a>
              </li>
              <li>
                <a href="soil-testing.html" target="_blank">Soil Testing</a>
              </li>
              <li><a href="chatbot.html" target="_blank">AI Chatbot</a></li>
              <li><a href="community.html" target="_blank">Community</a></li>
              <li><a href="renting.html" target="_blank">Rent Equipment</a></li>
            </ul>
          </div>
          <div class="footer-contact">
            <h4>Contact Us</h4>
            <p><i class="fas fa-phone"></i> +91 79918 81482</p>
            <p><i class="fas fa-envelope"></i> niranjanneel009@gmail.com</p>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2024 Krishi Kishan. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <script>
      document
        .getElementById("loginForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const email = document.getElementById("email").value;
          const password = document.getElementById("password").value;
          const rememberMe = document.getElementById("remember").checked;

          try {
            const response = await fetch("http://localhost:3000/api/login", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ email, password }),
            });

            const data = await response.json();

            if (response.ok) {
              // Store user data in localStorage
              localStorage.setItem("user", JSON.stringify(data.user));

              // If remember me is checked, store the email
              if (rememberMe) {
                localStorage.setItem("rememberedEmail", email);
              } else {
                localStorage.removeItem("rememberedEmail");
              }

              // Show success message
              const successMessage = document.createElement("div");
              successMessage.className = "success-message";
              successMessage.textContent = "Login successful! Redirecting...";
              document
                .querySelector(".login-content")
                .appendChild(successMessage);

              // Get return URL from URL parameters or default to soil-testing.html
              const urlParams = new URLSearchParams(window.location.search);
              const returnUrl = urlParams.get("return") || "soil-testing.html";

              // Redirect after a short delay
              setTimeout(() => {
                window.location.href = returnUrl;
              }, 1500);
            } else {
              // Show error message
              const errorMessage = document.createElement("div");
              errorMessage.className = "error-message";
              errorMessage.textContent = data.error || "Login failed";
              document
                .querySelector(".login-content")
                .appendChild(errorMessage);

              // Remove error message after 3 seconds
              setTimeout(() => {
                errorMessage.remove();
              }, 3000);
            }
          } catch (error) {
            console.error("Error:", error);
            const errorMessage = document.createElement("div");
            errorMessage.className = "error-message";
            errorMessage.textContent = "An error occurred during login";
            document.querySelector(".login-content").appendChild(errorMessage);

            // Remove error message after 3 seconds
            setTimeout(() => {
              errorMessage.remove();
            }, 3000);
          }
        });

      // Check for remembered email on page load
      document.addEventListener("DOMContentLoaded", () => {
        const rememberedEmail = localStorage.getItem("rememberedEmail");
        if (rememberedEmail) {
          document.getElementById("email").value = rememberedEmail;
          document.getElementById("remember").checked = true;
        }
      });

      // Add styles for success and error messages
      const style = document.createElement("style");
      style.textContent = `
        .success-message {
          background-color: #4CAF50;
          color: white;
          padding: 10px;
          border-radius: 5px;
          margin-top: 10px;
          text-align: center;
        }
        .error-message {
          background-color: #f44336;
          color: white;
          padding: 10px;
          border-radius: 5px;
          margin-top: 10px;
          text-align: center;
        }
      `;
      document.head.appendChild(style);

      document.getElementById("registerLink").addEventListener("click", (e) => {
        e.preventDefault();
        window.location.href = "register.html";
      });

      // Toggle password visibility
      const togglePassword = document.querySelector(".toggle-password");
      const passwordInput = document.querySelector("#password");

      togglePassword.addEventListener("click", () => {
        const type =
          passwordInput.getAttribute("type") === "password"
            ? "text"
            : "password";
        passwordInput.setAttribute("type", type);
        togglePassword.querySelector("i").classList.toggle("fa-eye");
        togglePassword.querySelector("i").classList.toggle("fa-eye-slash");
      });

      // Social login buttons
      const socialButtons = document.querySelectorAll(".social-btn");
      socialButtons.forEach((button) => {
        button.addEventListener("click", () => {
          // Add social login logic here
          alert("Social login coming soon!");
        });
      });
    </script>
  </body>
</html>
